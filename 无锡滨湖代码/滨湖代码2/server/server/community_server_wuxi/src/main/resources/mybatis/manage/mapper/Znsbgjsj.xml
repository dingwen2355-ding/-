<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.znv.manage.dao.ZnsbgjsjDao">

    <!--工地监管预警-->
    <select id="countZnsbgjsjToday" resultType="java.lang.Integer">
        SELECT count(1)
        FROM t_17_znsbgjsj
        WHERE 1=1
        <if test="beginTime != null">
            AND  alarm_time &gt;= #{beginTime}
        </if>
        <if test="endTime != null">
            AND alarm_time &lt;= #{endTime}
        </if>
        <if test="beginTime == null and endTime == null ">
            AND DATE(alarm_time) = CURDATE()
        </if>
    </select>

    <select id="ZnsbgjsjTodayList" resultType="java.util.Map">
        SELECT
            DATE_FORMAT(alarm_time,'%Y-%m-%d %h:%i:%s') as alarmTime
        FROM
            t_17_znsbgjsj
        WHERE 1=1
        <if test="beginTime != null">
            AND  alarm_time &gt;= #{beginTime}
        </if>
        <if test="endTime != null">
            AND alarm_time &lt;= #{endTime}
        </if>
        <if test="beginTime == null and endTime == null ">
            AND DATE(alarm_time) = CURDATE()
        </if>
        ORDER BY alarm_time DESC
    </select>

    <insert id="insertZnsbgjsjList">
        INSERT INTO t_17_znsbgjsj
        (alarm_time,
        collect_time,
        create_time,
        photo_url,
        xmbh,
        alarm_no,
        xcfzr,
        lxfs)
        VALUES
        <foreach collection="list" item="item" index="index" separator=",">
        (#{item.alarmTime},
        #{item.collectTime},
        #{item.createTime},
        #{item.photoUrl},
        #{item.xmbh},
        #{item.alarmNo},
        #{item.xcfzr},
        #{item.lxfs})
        </foreach>
    </insert>

    <select id="queryAlarmNo" resultType="java.util.Map">
        select alarm_no as alarmNo from t_17_znsbgjsj
    </select>
</mapper>